--- bin/fribidi-benchmark.c	2006-01-31 04:23:12.000000000 +0100
+++ bin/fribidi-benchmark.c	2009-04-14 05:49:52.000000000 +0200
@@ -58,6 +58,9 @@
 #if HAVE_SYS_TIMES_H+0
 # include <sys/times.h>
 #endif
+#ifdef _WIN32
+#include <windows.h>
+#endif /* _WIN32 */
 
 #include "getopt.h"
 
@@ -123,12 +126,26 @@
   void
 )
 {
-  struct tms tb;
+#ifdef _WIN32
+  FILETIME creationTime, exitTime, kernelTime, userTime;
+  HANDLE currentProcess = GetCurrentProcess();
+  if (GetProcessTimes(currentProcess, &creationTime, &exitTime, &kernelTime, &userTime))
+  {
+      unsigned __int64 myTime = userTime.dwHighDateTime;
+      myTime = (myTime << 32) | userTime.dwLowDateTime;
+      return 1e-7 * myTime;
+  }
+  else
+      return 0.0;
+#else /* !_WIN32 */
 #if HAVE_SYS_TIMES_H+0
+  struct tms tb;
   times (&tb);
   return 0.01 * tb.tms_utime;
 #else
 #warning Please fill in here to use other functions for determining time.
+  return 0.0;
+#endif
 #endif
 }
 
