INCLUDE(admCheckGtk)
INCLUDE(admCheckGettext)
INCLUDE(admPluginVideoEncoder)

checkGtk()

IF (GTK_FOUND AND GTHREAD_FOUND)
	checkGettext()

	IF (GETTEXT_FOUND)
		ADD_DEFINITIONS("-DHAVE_GETTEXT")
		INCLUDE_DIRECTORIES(${GETTEXT_INCLUDE_DIR})
	ENDIF (GETTEXT_FOUND)

	SET(ADM_vidEnc_x264_Gtk_SRCS gtkSupport.cpp x264ConfigDialog.cpp)

	ADD_DEFINITIONS(${GTK_CFLAGS})
	ADD_LIBRARY(${GTK_PLUGIN_NAME} SHARED ${ADM_vidEnc_x264_Gtk_SRCS})
	TARGET_LINK_LIBRARIES(${GTK_PLUGIN_NAME} ADM_vidEnc_x264 ${GTK_LDFLAGS} ${GTHREAD_LDFLAGS})
	
	IF (GETTEXT_FOUND)
		TARGET_LINK_LIBRARIES(${GTK_PLUGIN_NAME} ${GETTEXT_LIBRARY_DIR})
	ENDIF(GETTEXT_FOUND)

	INIT_VIDEO_ENCODER_PLUGIN(ADM_vidEnc_x264_Gtk)
	INSTALL(TARGETS ADM_vidEnc_x264_Gtk DESTINATION "${CMAKE_INSTALL_PREFIX}/lib/ADM_plugins/videoEncoder/${PLUGIN_SUBDIR}")
ENDIF (GTK_FOUND AND GTHREAD_FOUND)